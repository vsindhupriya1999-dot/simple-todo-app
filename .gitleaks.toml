# Gitleaks configuration tuned for this repository
# This config enables diff/PR scanning and has an allowlist for README files

[rules]
  [[rules.rules]]
  id = "generic-api-key"
  description = "Generic API key or secret in code"
  regex = '''(?i)(api[_-]?key|secret|token)["' ]?[:=\s]{1,}['\"]?[0-9A-Za-z\-\._]{8,}['\"]?'''

  [[rules.rules]]
  id = "aws-access-key"
  description = "AWS Access Key ID"
  regex = '''AKIA[0-9A-Z]{16}'''

[allowlist]
# Allowlist README files and course materials that contain example tokens or docs
  paths = [
    "README.MD",
    "README_TESTING.md"
  ]

# Fail on any match outside the allowlist
